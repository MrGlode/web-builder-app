<!-- src/app/features/visual-builder/components/visual-builder/visual-builder.component.html -->

<div 
  class="visual-builder"
  (keydown)="onKeyDown($event)"
  tabindex="0"
>
  
  <!-- ===== TOOLBAR ===== -->
  <header class="builder-header">
    <app-builder-toolbar></app-builder-toolbar>
  </header>
  
  <!-- ===== MAIN CONTENT ===== -->
  <div class="builder-main">
    
    <!-- ===== LEFT SIDEBAR: Component Palette ===== -->
    <aside class="builder-sidebar left">
      <app-component-palette
        (componentClick)="onComponentClick($event)"
      ></app-component-palette>
    </aside>
    
    <!-- ===== CENTER: Canvas ===== -->
    <main class="builder-canvas-container">
      <app-builder-canvas
        [components]="components()"
        [selectedComponentId]="selectedComponent()?.id || null"
        (componentSelected)="onComponentSelected($event)"
        (componentDropped)="onComponentDropped($event)"
      ></app-builder-canvas>
    </main>
    
    <!-- ===== RIGHT SIDEBAR: Tabs ===== -->
    <aside class="builder-sidebar right">
      
      <!-- Tabs Header -->
      <div class="sidebar-tabs">
        <button 
          class="tab-button"
          [class.active]="activeRightPanel() === 'layers'"
          (click)="switchRightPanel('layers')"
          title="Hiérarchie des composants"
        >
          📋 Layers
        </button>
        <button 
          class="tab-button"
          [class.active]="activeRightPanel() === 'properties'"
          (click)="switchRightPanel('properties')"
          title="Propriétés du composant"
        >
          ⚙️ Properties
        </button>
      </div>
      
      <!-- Tabs Content -->
      <div class="sidebar-content">
        
        <!-- Layers Panel -->
        @if (activeRightPanel() === 'layers') {
          <div class="layers-placeholder">
            <div style="padding: 40px; text-align: center; color: #999;">
              <p style="font-size: 48px; margin-bottom: 16px;">📋</p>
              <p>Layers Panel</p>
              <p style="font-size: 12px; margin-top: 8px;">À implémenter</p>
            </div>
          </div>
        }
        
        <!-- Properties Panel -->
        @if (activeRightPanel() === 'properties') {
          <app-properties-panel
            [selectedComponent]="selectedComponent()"
            [visible]="true"
            (propertyChanged)="onPropertyChanged($event)"
            (closed)="onPropertiesPanelClosed()"
          ></app-properties-panel>
        }
        
      </div>
      
    </aside>
    
  </div>
  
  <!-- ===== STATUS BAR ===== -->
  <footer class="builder-footer">
    <div class="status-info">
      <span class="status-item">
        📦 {{ componentCount() }} composant{{ componentCount() > 1 ? 's' : '' }}
      </span>
      @if (selectedComponent()) {
        <span class="status-item">
          📌 {{ selectedComponent()?.displayName }}
        </span>
      }
    </div>
  </footer>
  
</div>