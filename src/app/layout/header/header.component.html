<header class="header" role="banner">
  <!-- Left side - Logo & Menu Toggle -->
  <div class="header__left">
    <button 
      class="header__menu-btn"
      (click)="onToggleSidebar()"
      aria-label="Basculer le menu de navigation"
      aria-expanded="false">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
        <line x1="3" y1="12" x2="21" y2="12"></line>
        <line x1="3" y1="6" x2="21" y2="6"></line>
        <line x1="3" y1="18" x2="21" y2="18"></line>
      </svg>
    </button>
    
    <div class="header__logo">
      <svg width="32" height="32" viewBox="0 0 32 32" fill="currentColor" aria-hidden="true">
        <rect x="4" y="4" width="10" height="10" rx="2" />
        <rect x="18" y="4" width="10" height="10" rx="2" />
        <rect x="4" y="18" width="10" height="10" rx="2" />
        <rect x="18" y="18" width="10" height="10" rx="2" />
      </svg>
      <span class="header__title">Web Builder Platform</span>
    </div>
  </div>

  <!-- Right side - Actions -->
  <nav class="header__right" aria-label="Actions utilisateur">
    <!-- Notifications -->
    <button 
      class="header__action" 
      aria-label="Voir les notifications"
      *ngIf="authService.isAuthenticated()">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
        <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
        <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
      </svg>
      <span class="header__badge">3</span>
    </button>

    <!-- Settings -->
    <button 
      class="header__action" 
      aria-label="Ouvrir les paramètres"
      *ngIf="authService.isAuthenticated()">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
        <circle cx="12" cy="12" r="3"></circle>
        <path d="M12 1v6m0 6v6m-9-9h6m6 0h6"></path>
      </svg>
    </button>

    <!-- User menu (connecté) -->
    <div class="header__user-wrapper" *ngIf="authService.isAuthenticated()">
      <button 
        class="header__user" 
        aria-label="Menu utilisateur"
        aria-expanded="userMenuOpen()"
        (click)="toggleUserMenu()">
        <div class="header__avatar" aria-hidden="true">
          <span>{{ getUserInitials() }}</span>
        </div>
        <span class="header__username">{{ getUserFullName() }}</span>
        <svg 
          width="16" 
          height="16" 
          viewBox="0 0 24 24" 
          fill="none" 
          stroke="currentColor" 
          stroke-width="2"
          class="header__chevron"
          [class.header__chevron--open]="userMenuOpen()">
          <polyline points="6 9 12 15 18 9"></polyline>
        </svg>
      </button>

      <!-- Dropdown menu -->
      <div 
        class="header__dropdown"
        [class.header__dropdown--open]="userMenuOpen()"
        *ngIf="userMenuOpen()">
        <div class="header__dropdown-header">
          <div class="header__dropdown-avatar">{{ getUserInitials() }}</div>
          <div class="header__dropdown-info">
            <p class="header__dropdown-name">{{ getUserFullName() }}</p>
            <p class="header__dropdown-email">{{ authService.currentUser()?.email }}</p>
            <span class="header__dropdown-role" *ngIf="authService.isAdmin()">
              Administrateur
            </span>
          </div>
        </div>

        <div class="header__dropdown-divider"></div>

        <nav class="header__dropdown-menu" role="menu">
          <button 
            class="header__dropdown-item" 
            role="menuitem"
            (click)="navigateToProfile()">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
              <circle cx="12" cy="7" r="4"></circle>
            </svg>
            <span>Mon profil</span>
          </button>

          <button 
            class="header__dropdown-item" 
            role="menuitem"
            (click)="navigateToSettings()">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="3"></circle>
              <path d="M12 1v6m0 6v6m-9-9h6m6 0h6"></path>
            </svg>
            <span>Paramètres</span>
          </button>

          <div class="header__dropdown-divider"></div>

          <button 
            class="header__dropdown-item header__dropdown-item--danger" 
            role="menuitem"
            (click)="logout()">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
              <polyline points="16 17 21 12 16 7"></polyline>
              <line x1="21" y1="12" x2="9" y2="12"></line>
            </svg>
            <span>Déconnexion</span>
          </button>
        </nav>
      </div>
    </div>

    <!-- Login button (non connecté) -->
    <button 
      class="header__login-btn"
      (click)="login()"
      *ngIf="!authService.isAuthenticated()">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"></path>
        <polyline points="10 17 15 12 10 7"></polyline>
        <line x1="15" y1="12" x2="3" y2="12"></line>
      </svg>
      <span>Connexion</span>
    </button>
  </nav>
</header>

<!-- Backdrop pour fermer le menu -->
<div 
  class="header__backdrop"
  *ngIf="userMenuOpen()"
  (click)="closeUserMenu()">
</div>